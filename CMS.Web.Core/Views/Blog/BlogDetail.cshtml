@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div id="blogDetail">
    <b-loading :is-full-page="true" v-model="isLoading" :can-cancel="true"></b-loading>  
    <template>
        <nav class="breadcrumb" aria-label="breadcrumb">
            <ul>
                <li>
                    <a asp-controller="Home" asp-action="Index">Anasayfa</a>
                </li>
                <li>
                    <a v-bind:href="blog.categoryUrl">{{blog.categoryName}}</a>
                </li>
                <li class="is-active">
                    <a v-bind:href="blog.url">{{blog.title}}</a>
                </li>
            </ul>
        </nav>       
            <div class="columns is-desktop">
                <div class="column is-8">
                    <div class="card">
                        <div class="card-content">    
                            <div>
                                <h5 class="title is-5">{{blog.title}}</h5>                          
                            </div>    
                            <div id="content" class="w-100 has-text-justified mt-3" v-html="blog.content">
                            </div>
                        </div>                        
                        <div class="border-top pl-5">
                            <div class="columns is-desktop">
                                <div class="column pt-4">
                                    <h6 class="title is-6 content mt-2">
                                        Etiketler
                                    </h6>
                                </div>                               
                            </div>
                            <div class="columns is-desktop">
                                <div class="column pt-0">
                                    <b-tag><a>Tag label 1</a></b-tag>
                                    <b-tag>Tag label 2</b-tag>
                                    <b-tag>Tag label 3</b-tag> 
                                </div>                                                              
                            </div>
                         </div>
                    </div>
                    <b-collapse class="card mt-5" animation="slide" aria-id="comments">
                        <div slot="trigger" slot-scope="props" class="card-header" role="button" aria-controls="comments">
                            <p class="card-header-title">
                                Yorumlar (2)
                            </p>
                            <a class="card-header-icon">
                                <b-icon
                                    :icon="props.open ? 'menu-down' : 'menu-up'">
                                </b-icon>
                            </a>                            
                        </div>
                        <div class="card-content">
                            <div class="content">
                                <article class="media">
                                  <figure class="media-left">
                                    <p class="image is-64x64">
                                      <img src="https://bulma.io/images/placeholders/128x128.png">
                                    </p>
                                  </figure>
                                  <div class="media-content">
                                    <div class="content">
                                      <p>
                                        <strong>John Smith</strong>
                                        <small class="pull-right">04.11.2020</small>
                                        <br>
                                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin ornare magna eros, eu pellentesque tortor vestibulum ut. Maecenas non massa sem. Etiam finibus odio quis feugiat facilisis.
                                      </p>
                                    </div>                                    
                                  </div>                                  
                                </article>
                            </div>
                        </div>
                    </b-collapse>
                    <div class="card mt-5">
                        <div class="card-header-title">
                            Bu Haberler de İlginizi Çekebilir
                        </div>
                        <div class="card-content">
                             <b-carousel
        :autoplay="false"
        with-carousel-list
        :indicator="false"
        :overlay="gallery"
        v-on:click="switchGallery(true)">
        <b-carousel-item v-for="(item, i) in items" :key="i">
            <figure class="image">
                <img :src="item.image">
            </figure>
        </b-carousel-item>
        <span v-if="gallery" v-on:click="switchGallery(false)" class="modal-close is-large"/>
        <template slot="list" slot-scope="props">
            <b-carousel-list
                v-model="props.active"
                :data="items"
                v-bind="al"
                v-on:switch="props.switch($event, false)"
                as-indicator />
        </template>
        <template slot="overlay">
            <div class="has-text-centered has-text-white">
                Hello i'am overlay!
            </div>
        </template>
    </b-carousel>
                        </div>
                    </div>

                </div>
                <div class="column is-4">
                    <div class="card">
                    <header class="card-header">
                        <div class="card-header-title">
                            Çok Okunanlar
                        </div>
                     </header>
                    </div>
                </div>               
            </div>
    </template>
</div>


@section Scripts {
    <script>
        new Vue({
            el: '#blogDetail',
            data: {
                blog: Object,
                url:"",
                isLoading: true,
                 gallery: false,
            al: {
                hasGrayscale: true,
                itemsToShow: 2,
                breakpoints: {
                    768: {
                        hasGrayscale: false,
                        itemsToShow: 4
                    },
                    960: {
                        hasGrayscale: true,
                        itemsToShow: 6
                    }
                }
            },
            items: [
                {
                    title: 'Slide 1',
                    image: 'https://picsum.photos/id/0/1230/500'
                },
                {
                    title: 'Slide 2',
                    image: 'https://picsum.photos/id/1/1230/500'
                },
                {
                    title: 'Slide 3',
                    image: 'https://picsum.photos/id/2/1230/500'
                },
                {
                    title: 'Slide 4',
                    image: 'https://picsum.photos/id/3/1230/500'
                },
                {
                    title: 'Slide 5',
                    image: 'https://picsum.photos/id/4/1230/500'
                },
                {
                    title: 'Slide 6',
                    image: 'https://picsum.photos/id/5/1230/500'
                },
                {
                    title: 'Slide 7',
                    image: 'https://picsum.photos/id/6/1230/500'
                },
                {
                    title: 'Slide 8',
                    image: 'https://picsum.photos/id/7/1230/500'
                }
            ]
            },
            created: function () {
             this.url = window.location.pathname;
             this.blogList();
            },
            methods: {
                blogList: function () {
                    axios.get("/api/Blog/GetBlogByUrl?url=" + this.url)
                    .then(res => {
                        this.isLoading = false;
                        this.blog = res.data;
                        document.title = res.data.title + " - CMS";

                    })
                    .catch(e => {
                        window.location = "/error/404";
                    });;
                },
                switchGallery(value) {
            this.gallery = value
            if (value) {
                document.documentElement.classList.add('is-clipped')
            } else {
                document.documentElement.classList.remove('is-clipped')
            }
        }
            }
        });
    </script>
}



